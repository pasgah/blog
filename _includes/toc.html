{% comment %}
TOC ساده با جاوااسکریپت: h2 و h3 را از داخل .post-content می‌خواند
{% endcomment %}

<div id="toc" style="margin:1.5rem 0; padding:1rem; border-radius:12px; border:1px solid var(--border); background:var(--card);">
  <strong>فهرست مطالب</strong>
  <ul id="toc-list" style="list-style:none; padding-right:1rem; margin-top:0.8rem;"></ul>
</div>

<script>
  (function() {
    const content = document.querySelector('.post-content');
    if (!content) return;

    const headings = content.querySelectorAll('h2, h3');
    if (!headings.length) {
      document.getElementById('toc').style.display = 'none';
      return;
    }

    const list = document.getElementById('toc-list');

    headings.forEach((h, index) => {
      if (!h.id) h.id = 'section-' + index;
      const li = document.createElement('li');
      li.style.marginBottom = '0.3rem';
      if (h.tagName === 'H3') li.style.marginRight = '1rem';

      const a = document.createElement('a');
      a.href = '#' + h.id;
      a.textContent = h.textContent;

      li.appendChild(a);
      list.appendChild(li);
    });
  })();
</script>
